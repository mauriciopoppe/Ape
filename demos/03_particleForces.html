<!DOCTYPE html>
<html>
<head>
    <title>Archimedes Physics Engine test</title>
    <script src="lib/stats.min.js"></script>

    <script src="lib/Extend.js"></script>
    <script src="lib/Game.js"></script>

    <script src="js/Core.js"></script>
    <script src="js/Vector3.js"></script>

    <script src="js/Constants.js"></script>
    <script src="js/Particle.js"></script>
    <script src="js/ParticleFactory.js"></script>

    <script src="js/ParticleForceRegistry.js"></script>
    <script src="js/ParticleForceGenerator.js"></script>
    <script src="js/ParticleDrag.js"></script>
    <script src="js/ParticleGravity.js"></script>

    <link rel="stylesheet" href="css/master.css"/>
</head>
<body>
    <canvas id="app" width="1000" height="600"></canvas> <br />
    <button onclick="pause()">PAUSE</button>
    <script type="text/javascript">
        console.log('%c>> APE up and running!', 'color: #6FC3DF');
        var canvas = document.getElementById('app');
        var context = canvas.getContext('2d');
        var width = canvas.width, height = canvas.height;

        // invert
        var k = 1;
        context.translate(0, height);
        context.scale(k, -k);

        // particle
        var particles = [];
        particles.push(
            Ape.ParticleFactory(Ape.ParticleFactory.PISTOL)
        );
        particles.push(
            Ape.ParticleFactory(Ape.ParticleFactory.ARTILLERY)
        );
        particles.push(
            Ape.ParticleFactory(Ape.ParticleFactory.FIREBALL)
        );
        particles.push(
            Ape.ParticleFactory(Ape.ParticleFactory.LASER)
        );

        var particleRegistry = new Ape.ParticleForceRegistry();

        // adding gravity to the artillery particle
        particleRegistry.add(
            particles[1],
            new Ape.ParticleGravity(
                Ape.GRAVITY
            )
        );

        // adding drag to the laser particle
        particleRegistry.add(
            particles[3],
            new Ape.ParticleDrag(0.5, 0.5)
        );

        Game = Game || {};
        Game.setUp({
            context: context,
            reset: function () {
                this.context.clearRect(0, 0, width, height);
            },
            update: function (delta) {
                particleRegistry.update(delta);
                particles.forEach(function (particle) {
                    particle.integrate(delta);
                });
            },
            render: function () {
                particles.forEach(function (particle) {
                    this.context.beginPath();
                    this.context.arc(particle.position.x, particle.position.y, 5, 0, 2 * Math.PI, false);
                    this.context.fillStyle = particle.color;
                    this.context.fill();
                });
            }
        });
        Game.launch();

        function pause() {
            Game.controls.togglePause();
        }
    </script>
</body>
</html>